# W6D2 note

## Miss Rate相关

### 如何降低miss rate？

增大缓存的总大小可以降低missrate。但是在给定缓存总大小的情况下，我们可以注意到，增大block size对miss rate的影响却是先减少后增加的。原因主要为两点：

1. 块的变大能增加空间局部性(space locality)，并且其也会减少强制失效
2. 块的变大也导致了缓存中块数目减小，这有可能会增加冲突失效。值
   得注意的是，在缓存总大小较小时，这亦会导致更多的容量失效

提高关联度也可以类似的效果

victim cache:这个缓存的特点是他保存了缓存里面最近被代替掉的数据。那么我们在找内容的时候是从两个缓存中各找一份，来达到降低miss rate的目的。

伪相连策略：它结合了多路组相联的低不命中率和直接映像的命中速度。它通过索引最高位进行分割，首先按照直接映射的方式匹配表示，如果不成功匹配，则将最高位取反再次进行匹配。

硬件和软件的预取：硬件预取可以预先将指令和数据读入快速存储器，比方说如果 miss 了，就把后面两个数据块都读进来，但是前提是不能影响程序的正常工作，即预取数据的时候处理器还是能继续进行或者硬件还能占有同样的带宽，否则反而可能是无用功。软件预取是在说，直接把要 load 的数据放进寄存器，或者将它放进 cache。

比如说，在进行对数组的遍历操作的时候，我们实施预取，就能很好的避免complusory miss.

### 编译器相关优化

编译器内存相关的优化，核心就是希望通过重新安排排各过程的位置，减少可能的comflict misses，达到提升效率的结果

合并数组：提高空间的局部性

循环互换：使得缓存利用效率更高。

循环融合：同样提高缓存利用效率（比如两个循环都会用到a[i]，合并后可以显著降低miss rate）